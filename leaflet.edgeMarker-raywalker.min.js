/** Leaflet.EdgeMarker-raywalker - 0.1.0 - 2014-03-25 - MIT License - https://github.com/raywalker-it/Leaflet.EdgeMarker-raywalker */
!function(a,b){"use strict";a.EdgeMarker=a.Class.extend({options:{radius:30,weight:1,color:"white",fillColor:"white",fillOpacity:1,className:"edgeMarker",transitionClass:"quickFadeOut"},timer:!1,delay:100,initialize:function(b){a.setOptions(this,b)},addTo:function(c){var d=!1;return this._map=c,a.extend(c,{_getFeatures:function(){var a=[];for(var b in this._layers)"undefined"!=typeof this._layers[b].getLatLng&&a.push(this._layers[b]);return a}}),c.on("move",function(){var a=this;"undefined"!=typeof this._borderMarkerLayer&&b("."+this.options.className).addClass(this.options.transitionClass),d&&clearTimeout(d),d=setTimeout(function(){a._addEdgeMarkers()},a.delay)},this),c.on("viewreset",function(){var a=this;"undefined"!=typeof this._borderMarkerLayer&&this._borderMarkerLayer.clearLayers(),d&&clearTimeout(d),d=setTimeout(function(){a._addEdgeMarkers()},a.delay)},this),this._addEdgeMarkers(),c.addLayer(this),this},onAdd:function(){},_borderMarkerLayer:!1,_addEdgeMarkers:function(){this._borderMarkerLayer||(this._borderMarkerLayer=new a.LayerGroup),this._borderMarkerLayer.clearLayers();var c=this._map._getFeatures(),d=!1,e=!1,f=this;b.each(c,function(c,g){var h=g.feature;if("undefined"!=typeof h.properties.edgeMarker){var i=b.extend(!0,{className:f.options.className},h.properties.edgeMarker),j=g.getLatLng(),k=f._map.latLngToContainerPoint(j),l=f._map.getSize();if(k.y<0||k.y>l.y||k.x>l.x||k.x<0){var m=k.y,n=k.x,o=i.iconSize[0]/2.2,p=i.iconSize[1]/2.2;k.y<0?(m=0,i.iconAnchor[1]=i.iconAnchor[1]-p):k.y>l.y&&(m=l.y,i.iconAnchor[1]=i.iconAnchor[1]+p),k.x>l.x?(n=l.x,i.iconAnchor[0]=i.iconAnchor[0]+o):k.x<0&&(n=0,i.iconAnchor[0]=i.iconAnchor[0]-o),"object"==typeof h.properties.icon?(d=a.marker(f._map.containerPointToLatLng([n,m]),{icon:a.divIcon({className:f.options.className+" edgeMarkerCircle",iconSize:[2*f.options.radius,2*f.options.radius]})}).addTo(f._borderMarkerLayer),e=a.marker(f._map.containerPointToLatLng([n,m]),{icon:a.icon(i)}).addTo(f._borderMarkerLayer)):e=a.circleMarker(f._map.containerPointToLatLng([n,m]),f.options).addTo(f._borderMarkerLayer),e.on("click",function(){f._map.panTo(j,{animate:!0})}),d&&d.on("click",function(){f._map.panTo(j,{animate:!0})})}}}),this._map.hasLayer(this._borderMarkerLayer)||this._borderMarkerLayer.addTo(this._map)}}),a.edgeMarker=function(b){return new a.EdgeMarker(b)}}(L,jQuery);